<script>
    function dlAddToCart() {
        //console.log("funciÃ³n corre");
        var pageCategory = $(this).data("producttype");
        var productBrand = $(this).data("productbrand");
        var productName = $(this).data("producttitle");
        var productPrice = $(this).data("productprice");
        var productSKU = $(this).data("productsku");
        var productVariant = $(this).data("productvariant");
        var productVariantTitle = $(this).data("productvarianttitle");
        if(document.getElementById("input-qty")) {
            var productQty = document.querySelector('#input-qty').value;
          } else {
            var productQty = 1;
          };
        //console.log('variable productQTY lista');
        const currentURL = window.location.href;


        //console.log("variables capturadas");
        //console.log(productName);

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
        'event': 'add_to_cart',
        'ecommerce': {
            'items': [{
              'item_name': `${productName}`, // Name or ID is required.
              'item_id': `${productVariant}`,
              'price': `${productPrice}`,
              'item_brand': `${productBrand}`,
              'item_category': `${pageCategory}`,
              'item_variant': `${productVariantTitle}`,
              'item_list_name': `${currentURL}`,
              'item_list_id': '',
              'index': 1,
              'quantity': `${productQty}`
            }]
        }
        });

        //console.log('AddToCart event');
        //console.log('dataLayer', JSON.stringify(dataLayer, null, 0));
    };

    window.addEventListener('DOMContentLoaded', (event) => {
      //const currentURL = window.location.href;
      const addToCartButtons = document.querySelectorAll('button.add-to-cart');
        addToCartButtons.forEach(function(addToCartButton) {
          //console.log('button de add to cart');
          addToCartButton.addEventListener('click', dlAddToCart);
      });
    });
</script>

{% comment %}

A futuro agregar el datalayer con un event handler en los botones de la seccion de add to cart de momiji points.
Por ahi estan los nombres de las clases.

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const currentURL = window.location.href;
    const addToCartButtons = document.querySelectorAll('button.add-to-cart, #AddToCart, button.btn__agregar, button.btn__midabi, .button-add, .lion-redeem-reward-modal__button--confirm');
                addToCartButtons.forEach(function(addToCartButton) {
      console.log('button click');
      addToCartButton.addEventListener('click', dlAddToCart);
    });
  });
</script>
{% endcomment %}
