function closeMinicart() { $("#mm_cartoverlay").animate({ right: "-100vw" }), $("body").removeClass("cart-open") } function updateCart(t, a) { $.ajax({ type: "post", url: "/cart/change.js", data: { id: t, quantity: a }, dataType: "json", success: function (t) { updateMinicart() } }) } function removeItemcart(t) { $.ajax({ type: "post", url: "/cart/change.js", data: { id: t, quantity: 0 }, dataType: "json", success: function (t) { updateMinicart() } }) } function addItemtocart(t) { $.ajax({ type: "post", url: "/cart/add.js", data: t, dataType: "json", success: function (t) { console.log("item added"), updateMinicart() } }) } function updateMinicart() { $.ajax({ type: "GET", url: "/", success: function (t) { console.log("minicart loaded"), $("#cart_temp_late form").css("opacity", "1"); var a = $(t).filter("#mm_cartoverlay").html(); $(document).find("#mm_cartoverlay").html(a), $("body").addClass("cart-open"), $("#mm_cartoverlay").animate({ right: "0" }) } }) } function reveal(t) { var a = document.getElementById(t); if ("flex" == a.style.display) a.style.display = "none"; else { for (var n = document.querySelectorAll(".hidden_tyc"), e = 0, c = n.length; e < c; e++)n[e].style.display = "none"; a.style.display = "flex" } } $(document).on("click", ".cart-summary", function (t) { t.preventDefault(), $("body").addClass("cart-open"), $("#mm_cartoverlay").animate({ right: "0" }), $("#cart_temp_late form").css("opacity", "0.2"), updateMinicart() }), $(document).on("click", ".refresh-btn", function (t) { t.preventDefault(), $("#cart_temp_late form").css("opacity", "0.2"), updateMinicart() }), $(document).on("click", "span.closecart_mm", function (t) { t.preventDefault(), closeMinicart() }), $(document).on("click", "#cart_temp_late .continue-shopping", function (t) { t.preventDefault(), closeMinicart() }), $(document).on("click", ".cart-open", function (t) { $(t.target).closest("#cart_temp_late").length || (t.stopPropagation(), closeMinicart()) }), $(document).on("click", ".recomended_pro_mm .button-add button", function (t) { t.preventDefault(); var a = $(this).data("variant"); $(this).text("Agregando..."), setTimeout(function () { addItemtocart({ id: a, quantity: 1 }) }, 300) }), $(document).on("click", ".minicart-summ .item .remove_mm", function (t) { t.preventDefault(); var a = $(this).data("variant_id"); $(this).text("Eliminando..."), setTimeout(function () { removeItemcart(a) }, 100) }), $(document).on("click", ".minicart-summ .item a.notabutton.quantity-up", function (t) { var a = $(this).closest(".quantity"), n = $(a).find("input").val(), e = $(a).data("variant"), c = parseInt(n) + 1; $(a).find("input").val(c), updateCart(e, c) }), $(document).on("click", ".minicart-summ .item a.notabutton.quantity-down", function (t) { var a = $(this).closest(".quantity"), n = $(a).find("input").val(), e = $(a).data("variant"), c = parseInt(n) - 1; 0 != c && ($(a).find("input").val(c), updateCart(e, c)) }), $(document).on("submit", '[action="/cart/add"]', function (t) { t.preventDefault(); var a = $(this).serialize(), n = $(this); $("#cart_temp_late form").css("opacity", "0.2"), setTimeout(function () { $(n).find(".button").val("Add to cart") }, 2e3), addItemtocart(a) });